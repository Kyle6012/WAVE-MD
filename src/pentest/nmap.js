// nmap.js
const Nmap = require('node-nmap');

function scanTarget(target, portRange) {
    return new Promise((resolve, reject) => {
        const nmapScan = new Nmap.NmapScan(target, '-p ' + portRange);
        
        nmapScan.on('complete', function(data) {
            const openPorts = data[0].openPorts.map(port => ({
                port: port.port,
                protocol: port.protocol
            }));
            resolve(openPorts);
        });

        nmapScan.on('error', function(error) {
            reject(error);
        });

        nmapScan.startScan();
    });
}

module.exports = scanTarget;
